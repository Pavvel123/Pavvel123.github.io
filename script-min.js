const SEMESTER_START="2025-09-29",SEMESTER_WEEKS=21;function range(e,t,a=1){const r=[];for(let n=e;n<=t;n+=a)r.push(n);return r}function fmtDM(e){return`${String(e.getDate())}.${String(e.getMonth()+1).padStart(2,"0")}`}function weekDateRange(e){const t=new Date(SEMESTER_START);t.setDate(t.getDate()+7*(e-1));const a=new Date(t);return a.setDate(a.getDate()+6),{start:t,end:a}}function normalizeToStudyDay(e){const t=new Date(e),a=t.getDay();return 6===a?(t.setDate(t.getDate()+2),t):0===a?(t.setDate(t.getDate()+1),t):t}function weekNumberForDate(e){const t=new Date(SEMESTER_START),a=new Date(e.getFullYear(),e.getMonth(),e.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=Math.floor(a/864e5);let n=Math.floor(r/7)+1;return n<1&&(n=1),n>SEMESTER_WEEKS&&(n=SEMESTER_WEEKS),n}const EVENTS=[
{id:"XBG",title:"Obowiązuje plan z wtorku!",day:3,start:"07:30",end:"22:00",place:"",teacher:"",color:"#007413ff",weeks:[7]},
{id:"XBG",title:"Obowiązuje plan z wtorku!",day:4,start:"07:30",end:"22:00",place:"",teacher:"",color:"#007413ff",weeks:[15]},
{id:"PG",title:"Projekt grupowy I",day:1,start:"09:15",end:"11:00",place:"AUD.NOV",teacher:"dr inż. Sławomir Gajewski",color:"#ffa672ff",weeks:[2,3,4,5,6,7,8,9,10,11,12,15,16,17,18]},
{id:"IO",title:"Inżynieria oprogramowania",day:1,start:"11:15",end:"13:00",place:"NE AUD1P",teacher:"dr inż. Aleksander Jarzębowicz",color:"#7274ffff",weeks:[2,3,4,5,6,7,8,9,10,11,12,15,16,17,18]},
{id:"ASW",title:"Aplikacje systemów wbudowanych",day:1,start:"13:15",end:"15:00",place:"NE AUD1P",teacher:"dr inż. Krzysztof Bikonis",color:"#7274ffff",weeks:[2,3,4,5,6,7,8,9,10,11,12,15,16,17,18]},
/*{id:"HD",title:"Hurtownie danych",day:1,start:"17:15",end:"19:00",place:"Zajęcia zdalne",teacher:"dr inż. Teresa Zawadzka",color:"#7274ffff",weeks:[2,3,4,5,6,7,8,9]},*/
{id:"SKL",title:"Sieci komputerowe - laboratorium",day:2,start:"11:15",end:"13:00",place:"EA 204",teacher:"mgr inż. Jakub Grochowski",color:"#b472ffff",weeks:[3,5,8,10,12,16]},
{id:"AUI",title:"Architektury usług internetowych",day:2,start:"11:15",end:"13:00",place:"WP 111",teacher:"mgr Anna Domagalska",color:"#b472ffff",weeks:[4,6,9,11,17]},
{id:"ASW",title:"Aplikacje systemów wbudowanych",day:2,start:"13:15",end:"15:00",place:"EA 438",teacher:"dr inż. Krzysztof Bikonis",color:"#b472ffff",weeks:[3,4,5,6,8,9,10,11,12,16,17,18]},
{id:"BE",title:"Biznes elektroniczny",day:2,start:"15:15",end:"17:00",place:"NE AUD1L",teacher:"dr inż. Andrzej Sobecki",color:"#7274ffff",weeks:[2,3,4,5,6,8,9]},
{id:"BE",title:"Biznes elektroniczny",day:2,start:"17:15",end:"19:00",place:"WP 121",teacher:"dr inż. Andrzej Sobecki",color:"#ffa672ff",weeks:[3,5,9,11,17]},
{id:"WI",title:"Wizualizacja informacji",day:3,start:"08:15",end:"10:00",place:"EA 401",teacher:"mgr inż. Jerzy Redlarski",color:"#ffa672ff",weeks:[10,11,12,15,16,17,18]},
{id:"JA",title:"Język angielski IV",day:3,start:"11:15",end:"12:45",place:"Gmach B 311",teacher:"mgr Ewa Rogala",color:"#ff2bedff",weeks:[1,2,3,4,5,6,8,9,10,11,12,15,16,17,18]},
{id:"SAI",title:"Społeczne aspekty informatyki",day:3,start:"13:15",end:"15:00",place:"NE AUD1P",teacher:"dr inż. Jakub Miler",color:"#7274ffff",weeks:[1,2,3,4,5,6,8]},
{id:"SIP",title:"Systemy informacji przestrzennej",day:3,start:"13:15",end:"15:00",place:"EA 643",teacher:"dr hab. Zbigniew Łubniewski",color:"#b472ffff",weeks:[10,11,12,15,16,17,18]},
{id:"SIP",title:"Systemy informacji przestrzennej",day:3,start:"15:15",end:"17:00",place:"NE AUD1L",teacher:"dr hab. Marcin Kulawiak",color:"#7274ffff",weeks:[1,2,3,4,5,6,8,9]},
{id:"HD",title:"Hurtownie danych",day:3,start:"18:15",end:"20:00",place:"Zajęcia zdalne",teacher:"dr inż. Teresa Zawadzka",color:"#7274ffff",weeks:[1]},
/*{id:"PG",title:"Projekt grupowy I",day:3,start:"19:15",end:"21:00",place:"NE 205",teacher:"dr inż. Krzysztof Gierłowski",color:"#ffa672ff",weeks:[2,3,4,5,6,8,9,10,11,12,15,16,17,18]},*/
{id:"SAI",title:"Społeczne aspekty informatyki",day:4,start:"08:15",end:"11:00",place:"NE 209",teacher:"dr inż. Jakub Miler",color:"#ffa672ff",weeks:[2,6,16]},
{id:"WI",title:"Wizualizacja informacji",day:4,start:"11:15",end:"13:00",place:"EA AUD2",teacher:"dr inż. Jacek Lebiedź",color:"#7274ffff",weeks:[1,2,3,4,5,6,7,8]},
{id:"HD",title:"Hurtownie danych",day:4,start:"13:15",end:"15:00",place:"EA 436",teacher:"mgr inż. Aleksandra Nabożny",color:"#b472ffff",weeks:[2,3,4,5,6,7,8,9,10,11,12,16,17,18]},
{id:"IO",title:"Inżynieria oprogramowania",day:5,start:"11:15",end:"13:00",place:"WP 121",teacher:"dr inż. Maciej Kucharski",color:"#b472ffff",weeks:[1,2,3,4,6,7,8,9,10,11,12,15,16,17,18]},
{id:"AUI",title:"Architektury usług internetowych",day:5,start:"13:15",end:"15:00",place:"NE AUD1P",teacher:"mgr inż. Michał Wójcik",color:"#7274ffff",weeks:[1,2,3,4,6,7,8,9,10,11,12,15,16,17,18]},
/*{id:"AUI",title:"Architektury usług internetowych",day:3,start:"11:15",end:"13:00",place:"WP 111",teacher:"mgr Anna Domagalska",color:"#b472ffff",weeks:[7]},*/
{id:"AUI",title:"Architektury usług internetowych (przeniesione z 7 października)",day:2,start:"09:15",end:"11:00",place:"WP 111",teacher:"mgr Anna Domagalska",color:"#b472ffff",weeks:[3]},
{id:"ASW",title:"Aplikacje systemów wbudowanych",day:3,start:"13:15",end:"15:00",place:"EA 438",teacher:"dr inż. Krzysztof Bikonis",color:"#b472ffff",weeks:[7]},{id:"BE",title:"Biznes elektroniczny",day:3,start:"15:15",end:"17:00",place:"NE AUD1L",teacher:"dr inż. Andrzej Sobecki",color:"#7274ffff",weeks:[7]},
{id:"BE",title:"Biznes elektroniczny",day:3,start:"17:15",end:"19:00",place:"WP 121",teacher:"dr inż. Andrzej Sobecki",color:"#ffa672ff",weeks:[7]},
{id:"AUI",title:"Architektury usług internetowych",day:4,start:"11:15",end:"13:00",place:"WP 111",teacher:"mgr Anna Domagalska",color:"#b472ffff",weeks:[15]},
{id:"ASW",title:"Aplikacje systemów wbudowanych",day:4,start:"13:15",end:"15:00",place:"EA 438",teacher:"dr inż. Krzysztof Bikonis",color:"#b472ffff",weeks:[15]},
{id:"BE",title:"Biznes elektroniczny",day:4,start:"17:15",end:"19:00",place:"WP 121",teacher:"dr inż. Andrzej Sobecki",color:"#ffa672ff",weeks:[15]},
{id:"SAI",title:"Społeczne aspekty informatyki",day:3,start:"15:15",end:"18:00",place:"NE 105",teacher:"dr inż. Sławomir Ostrowski",color:"#ffa672ff",weeks:[11]},
{id:"XEV",title:"ETIntegracja - Integracja wydziałowa",day:2,start:"17:15",end:"23:59",place:"Centrum Sportu Akademickiego",teacher:"",color:"#ffff00ff",weeks:[2]},
{id:"XFR",title:"Dzień Wolny",day:1,start:"07:30",end:"22:00",place:"",teacher:"",color:"#818181ff",weeks:[1]},
{id:"XFR",title:"Dzień Wolny",day:2,start:"07:30",end:"22:00",place:"",teacher:"",color:"#818181ff",weeks:[1]},
{id:"XFR",title:"Dzień Wolny",day:5,start:"07:30",end:"22:00",place:"",teacher:"",color:"#818181ff",weeks:[5]},
{id:"XHL",title:"Święto Niepodległości",day:2,start:"07:30",end:"22:00",place:"",teacher:"",color:"#ff4a4aff",weeks:[7]},
{id:"XFR",title:"Przerwa Świąteczno-Noworoczna",day:1,start:"07:30",end:"22:00",place:"",teacher:"",color:"#818181ff",weeks:[13,14]},
{id:"XFR",title:"Przerwa Świąteczno-Noworoczna",day:2,start:"07:30",end:"22:00",place:"",teacher:"",color:"#818181ff",weeks:[13,14]},
{id:"XHL",title:"Wigilia",day:3,start:"07:30",end:"22:00",place:"",teacher:"",color:"#ff4a4aff",weeks:[13]},
{id:"XHL",title:"Boże Narodzenie",day:4,start:"07:30",end:"22:00",place:"",teacher:"",color:"#ff4a4aff",weeks:[13]},
{id:"XHL",title:"Boże Narodzenie",day:5,start:"07:30",end:"22:00",place:"",teacher:"",color:"#ff4a4aff",weeks:[13]},
{id:"XFR",title:"Sylwester",day:3,start:"07:30",end:"22:00",place:"",teacher:"",color:"#818181ff",weeks:[14]},
{id:"XHL",title:"Nowy Rok",day:4,start:"07:30",end:"22:00",place:"",teacher:"",color:"#ff4a4aff",weeks:[14]},
{id:"XHL",title:"Przerwa Świąteczno-Noworoczna",day:5,start:"07:30",end:"22:00",place:"",teacher:"",color:"#818181ff",weeks:[14]},
{id:"XHL",title:"Święto Objawienia Pańskiego (Trzech Króli)",day:2,start:"07:30",end:"22:00",place:"",teacher:"",color:"#ff4a4aff",weeks:[15]}
],DAYS=["Poniedziałek","Wtorek","Środa","Czwartek","Piątek"],startHour=7,endHour=22,slotHeight=36,minutesPerSlot=30,timetable=document.getElementById("timetable"),timesCol=document.getElementById("timesCol"),weekSelect=document.getElementById("weekSelect"),daySelect=document.getElementById("daySelect"),todayBtn=document.getElementById("todayBtn");function buildWeekSelect(){weekSelect.innerHTML="";for(let e=1;e<=SEMESTER_WEEKS;e++){const{start:t,end:a}=weekDateRange(e),r=document.createElement("option");r.value=e,r.textContent=`${e}. (${fmtDM(t)} - ${fmtDM(a)})`,weekSelect.appendChild(r)}weekSelect.value=1}function buildDaySelect(){daySelect.innerHTML="";for(let e=0;e<DAYS.length;e++){const t=document.createElement("option");t.value=e+1,t.textContent=DAYS[e],daySelect.appendChild(t)}daySelect.value=1}function buildLayout(){timesCol.innerHTML="";for(let e=startHour;e<endHour;e++){const t=document.createElement("div");t.className="time-slot",t.textContent=`${String(e).padStart(2,"0")}:00`,t.style.color="rgb(220,220,220)";const a=document.createElement("div");a.className="time-slot",a.textContent=`${String(e).padStart(2,"0")}:30`,a.style.color="rgb(110,110,110)",timesCol.appendChild(t),timesCol.appendChild(a)}Array.from(timetable.querySelectorAll(".day-col")).forEach((e=>e.remove()));const e=Number(weekSelect.value)||1,t=new Date(SEMESTER_START);t.setDate(t.getDate()+7*(e-1));for(let e=0;e<DAYS.length;e++){const a=document.createElement("div");a.className="day-col",a.dataset.day=e+1;const r=document.createElement("div");r.className="day-header";const n=new Date(t);n.setDate(t.getDate()+e),r.textContent=`${DAYS[e]} ${fmtDM(n)}`,a.appendChild(r);const o=60/minutesPerSlot*(endHour-startHour);a.style.minHeight=o*slotHeight+"px",timetable.appendChild(a)}const a=window.matchMedia("(max-width:760px)").matches;timetable.style.gridTemplateColumns=a?"60px 1fr":`60px repeat(${DAYS.length},1fr)`}function parseTime(e){const[t,a]=e.split(":").map(Number);return 60*t+a}function minutesToTop(e){return(e-60*startHour)/minutesPerSlot*slotHeight}function formatWeeks(e){if(!e||!e.length)return"";const t=[...new Set(e)].sort(((e,t)=>e-t)),a=[];let r=t[0],n=t[0];for(let e=1;e<t.length;e++){const o=t[e];o===n+1?n=o:(a.push(r===n?String(r):`${r}-${n}`),r=n=o)}return a.push(r===n?String(r):`${r}-${n}`),a.join(",")}function eventOccursInWeek(e,t){return!e.weeks||Array.isArray(e.weeks)&&-1!==e.weeks.indexOf(t)}function clearRendered(){timetable.querySelectorAll(".day-col").forEach((e=>{Array.from(e.querySelectorAll(".event")).forEach((e=>e.remove())),Array.from(e.querySelectorAll(".now-line")).forEach((e=>e.remove()))}))}function renderEvents(){clearRendered();const e=Number(weekSelect.value),t=window.matchMedia("(max-width:760px)").matches,a=daySelect?Number(daySelect.value):null;timetable.style.gridTemplateColumns=t?"60px 1fr":`60px repeat(${DAYS.length},1fr)`,document.querySelectorAll(".day-col").forEach((e=>{e.style.display=t&&a?Number(e.dataset.day)===a?"block":"none":"block"}));for(const r of EVENTS){if(!eventOccursInWeek(r,e))continue;if(t&&a&&Number(r.day)!==a)continue;const n=timetable.querySelector(`.day-col[data-day='${r.day}']`);if(!n)continue;const o=parseTime(r.start)+16,l=parseTime(r.end)+23,i=minutesToTop(o),c=Math.max(28,(l-o)/minutesPerSlot*slotHeight-6),d=document.createElement("div");d.className="event",d.style.top=i+"px",d.style.height=c+"px",d.style.background=r.color||"#60a5fa",d.dataset.id=r.id,d.innerHTML=`\n          <div class="title">${escapeHtml(r.title)}</div>\n          <div class="meta">${escapeHtml(r.place||"")}${r.teacher?" • "+escapeHtml(r.teacher):""}</div>\n          <div class="time">${r.start} — ${r.end}</div>\n          <div class="weeks">Tyg.: ${escapeHtml(formatWeeks(r.weeks))}</div>\n        `,n.appendChild(d)}updateNowLine()}function escapeHtml(e){return e?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;"):""}function goToToday(){const e=normalizeToStudyDay(new Date),t=weekNumberForDate(e),a=e.getDay(),r=a>=1&&a<=5?a:1;weekSelect.value=t,daySelect&&(daySelect.value=r),buildLayout(),renderEvents(),window.scrollTo({top:0,behavior:"smooth"})}function updateNowLine(){document.querySelectorAll(".now-line").forEach((e=>e.remove()));const e=new Date;if(weekNumberForDate(e)!==Number(weekSelect.value))return;const t=60*e.getHours()+e.getMinutes();if(t<60*startHour||t>60*endHour)return;const a=minutesToTop(t)+18,r=window.matchMedia("(max-width:760px)").matches,n=daySelect?Number(daySelect.value):null;document.querySelectorAll(".day-col").forEach((e=>{const t=Number(e.dataset.day);if(r&&n&&t!==n)return;if(t!==(new Date).getDay())return;const o=document.createElement("div");o.className="now-line",o.style.top=a+"px",e.appendChild(o)}))}buildWeekSelect(),buildDaySelect(),buildLayout(),goToToday(),weekSelect.addEventListener("change",(()=>{buildLayout(),renderEvents()})),daySelect.addEventListener("change",renderEvents),todayBtn.addEventListener("click",goToToday),window.addEventListener("resize",(()=>{buildLayout(),requestAnimationFrame(renderEvents)})),setInterval(updateNowLine,600);
